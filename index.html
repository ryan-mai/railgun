<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Railgun</title>
    <meta name="description" content="Hello, World! - A-Frame">
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="DRACOLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.0/dist/aframe-extras.min.js"></script>

  </head>
  <body>
    <script>
    </script>
    <a-scene stats>
        <script>
        AFRAME.registerComponent('clickable', {
            init: function () {
            var loginEl = document.querySelector('#start_login');
            var skyEl = document.querySelector('a-sky');
            var sceneEl = document.querySelector('a-scene');
            this.el.addEventListener('click', function (evt) {
                sceneEl.removeChild(loginEl);
                textEl = document.createElement('a-entity');
                textEl.setAttribute('text', {value: 'Link Start'});
                textEl.setAttribute('position', {x: 3.5, y:1.6, z:-5});
                textEl.setAttribute('text', {width: 10, height: 10});
                sceneEl.appendChild(textEl);
                setTimeout(() => {
                    var linkEl = document.querySelector('#start');
                    skyEl.setAttribute('material', {src:'#start'});
                    linkEl.play();
                    sceneEl.removeChild(textEl)
                    linkEl.addEventListener('ended', function() {
                        skyEl.setAttribute('material', {color: '#000'});
                        window.location.href = "login.html";
                    })
                }, 1500);

                console.log('Hit At: ', evt.detail.intersection.point);
            });
            }
        });            
        </script>
        <a-assets>
          <video id="start" src="assets/videos/start.mp4"></video>
          <img id="begin" src="assets/images/begin.jpg">
          <img id="login" src="assets/images/Login.png">
        </a-assets>
        <a-image id="start_login" class="clickable" clickable src="#login" height="1" width="8" position="0 1.6 -5">
            <a-entity  text="value: Login; height: 10; width:10" position="1.5 0 0" color="#000">
            </a-entity>
        </a-image>

        <a-sky src="#begin" rotation="0 -90 0"></a-sky>
        <a-entity camera
            position="0 1.6 0"
            look-controls="true">
            <a-entity
                id="ray"
                cursor="fuse: true; rayOrigin: mouse"
                raycaster="showLine: true; far: 50; lineColor: red; interval: 500; objects: .clickable;"
                material="color: red; shader: flat"
                position="0 -1.6 0"
                rotation="0 0 0">
            </a-entity>

        </a-entity>
   </a-scene>
   <script>
    try { localStorage.setItem('visitedStart', 'true'); } catch (e) {}
    try {
      if (localStorage.getItem('playerLoggedIn') === 'true') {
        window.location.href = 'game.html';
      }
    } catch (e) {}

  </script>
  </body>
</html>